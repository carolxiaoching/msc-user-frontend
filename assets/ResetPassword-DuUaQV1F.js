import{L as S,m as h,f as r,o as N,R as B,u as E,j as x,l as s,n as t,w as d,i as p,F as L,k as _,S as j,p as i,Q as I,q as f,W as U}from"./index-DPTUyPy5.js";import{_ as z}from"./AlertModal-DSHdVdwG.js";const A={class:"d-flex flex-wrap justify-content-center aling-items-center my-17"},D={key:0,class:"mb-11 py-11 alert alert-danger"},Q={class:"mb-8"},T={class:"mb-16"},W={class:"mb-11 text-center"},$=["disabled"],K={__name:"ResetPassword",setup(G){const V=B(),b=E(),k=S(),R=h(),{openLoading:M,closeLoading:g}=k,{pushMessage:F}=R,m=r(),w=r(),u=r(""),a=r({token:"",password:"",confirmPassword:""});async function P(){var o,e,l;M();try{await U(a.value),(o=m.value)==null||o.openModal(),g()}catch(n){F({style:"danger",title:"重設密碼失敗",text:"重設密碼失敗，請重新設定"}),u.value=((l=(e=n.response)==null?void 0:e.data)==null?void 0:l.message)||"重設密碼失敗，請重新設定",g()}}function q(){var o;w.value.resetForm(),(o=m.value)==null||o.hideModal(),b.push("/signIn")}return N(()=>{const{token:o}=V.query;o?a.value.token=o:b.push("/")}),(o,e)=>{const l=p("VField"),n=p("ErrorMessage"),C=p("VForm");return _(),x(L,null,[s("section",A,[t(C,{class:"accountForm bg-white rounded-3 shadow",onSubmit:P,ref_key:"formRef",ref:w},{default:d(({errors:v,meta:y})=>[e[5]||(e[5]=s("h1",{class:"mb-8 text-center h3"},"重設您的密碼",-1)),e[6]||(e[6]=s("p",{class:"mb-11 text-center text-muted lh-lg"},"請輸入您的新密碼",-1)),u.value?(_(),x("p",D,[e[2]||(e[2]=s("i",{class:"bi bi-exclamation-triangle-fill me-4"},null,-1)),i(" "+I(u.value),1)])):j("",!0),s("div",Q,[e[3]||(e[3]=s("label",{for:"password",class:"d-block mb-4"},[s("span",{class:"text-danger"},"*"),i(" 新密碼： ")],-1)),t(l,{type:"password",name:"密碼",id:"password",class:f(["form-control",{"is-invalid":v.密碼}]),placeholder:"請輸入密碼",rules:"required",modelValue:a.value.password,"onUpdate:modelValue":e[0]||(e[0]=c=>a.value.password=c),required:""},null,8,["class","modelValue"]),t(n,{name:"密碼",class:"text-danger"})]),s("div",T,[e[4]||(e[4]=s("label",{for:"confirmPassword",class:"form-label"},[s("span",{class:"text-danger"},"*"),i(" 請再次輸入一次新密碼： ")],-1)),t(l,{type:"password",name:"確認密碼",id:"confirmPassword",class:f(["form-control",{"is-invalid":v.確認密碼}]),placeholder:"請輸入確認密碼",rules:"confirmed:@密碼",modelValue:a.value.confirmPassword,"onUpdate:modelValue":e[1]||(e[1]=c=>a.value.confirmPassword=c),required:""},null,8,["class","modelValue"]),t(n,{name:"確認密碼",class:"text-danger"})]),s("div",W,[s("button",{type:"submit","aria-disabled":"true",class:f(["w-75 btn btn-primary",{disabled:!y.valid}]),disabled:!y.valid}," 重設密碼 ",10,$)])]),_:1},512)]),t(z,{ref_key:"alertModalRef",ref:m},{"modal-header":d(()=>e[7]||(e[7]=[s("span",{class:"titleIcon bg-secondary text-white"},[s("i",{class:"bi bi-bell-fill"})],-1),i(" 密碼更新成功 ")])),"modal-content":d(()=>e[8]||(e[8]=[s("p",null,"密碼已成功更新",-1),s("p",null,"即將跳轉至登入頁面，請使用新密碼登入！",-1)])),"modal-footer":d(()=>[s("button",{type:"button",class:"w-50 btn btn-primary",onClick:q},"關閉")]),_:1},512)],64)}}};export{K as default};
